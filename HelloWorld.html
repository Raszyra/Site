<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hello, World! Full Game</title>
<style>
body { font-family: Arial; padding: 20px; background: #f0f0f0; margin-bottom: 220px; }
#game { display: flex; flex-wrap: wrap; gap: 20px; }
.deck, .player-area, .playarea, .ruleset, .cardinfo, .setup, .console { border: 1px solid #ccc; padding: 10px; border-radius: 8px; background: #fff; min-width: 220px; }
.card { margin: 5px; padding: 5px; border-radius: 5px; cursor: pointer; display:inline-block; }
.Function { background: #f88; }
.Variable { background: #88f; }
.Loop { background: #f90; }
.Library { background: #8f8; }
.Bonus { background: #ff8; }
.Bug { background: #333; color: #fff; }
.Event { background: #0ff; }
.IfElse { background: #a0a; color: #fff; }
.selected { border: 2px solid gold; }
.ruleset { position: fixed; bottom: 0; left: 0; right: 0; max-height: 200px; overflow-y: auto; background:#eee; transition:0.3s; }
.ruleset h3 { cursor:pointer; }
.ruleset.minimized { max-height:30px; overflow:hidden; }
.console { max-height: 150px; overflow-y: auto; background: #111; color: #0f0; font-family: monospace; }
</style>
</head>
<body>
<h1>Hello, World! Full Game</h1>

<div class="setup">
<h3>New Game</h3>
Players: <input type="number" id="numPlayers" min="2" value="3"><br>
Game Size: <select id="gameSize">
  <option value="quick">Quick Game</option>
  <option value="full">Full Game</option>
</select><br>
<button id="newGameBtn">Start Game</button>
</div>

<div id="game" style="display:none;">
  <div class="deck">
    <h3>Main Deck</h3>
    <button id="drawMainBtn">Draw from Main Deck</button>
    <div id="deckCount"></div>
  </div>

  <div class="playarea">
    <h3>Program Area</h3>
    <div id="programArea"></div>
    <button id="completeProgramBtn">Score Program</button>
    <button id="passBtn">Pass Turn</button>
    <button id="drawLangBtn">Draw from Language Deck</button>
  </div>

  <div id="players"></div>

  <div class="cardinfo">
    <h3>Card Info</h3>
    <div id="cardInfoText">Hover or click a card to see details.</div>
  </div>

  <div class="console">
    <h3>Console Log</h3>
    <div id="consoleLog"></div>
  </div>
</div>

<div class="ruleset" id="ruleset">
  <h3 onclick="toggleRules()">Ruleset (Click to minimize)</h3>
  <div id="rulesContent">
    <p>- Draw one card from Main or Language Deck per turn.<br>
    - Play one card of each type per turn.<br>
    - Variables must match function requirements.<br>
    - Functions require specific variables, libraries, loops.<br>
    - Complete programs with at least one Function.<br>
    - Score Variables + Bonuses + difficulty multipliers.<br>
    - First to complete 1 program (Quick) or 3 programs (Full) wins.<br>
    - Hand limit: 8 cards.<br></p>
  </div>
</div>

<script>
// --- Game Variables ---
let NUM_PLAYERS = 3;
let PROGRAMS_TO_WIN = 3;
const MAX_HAND = 8;
let currentPlayer = 0;
let mainDeck = [];
let players = [];
let selectedFunctionIndex = null;

// --- Utility Logger ---
function logAction(msg){
  const log=document.getElementById('consoleLog');
  const entry=document.createElement('div');
  entry.textContent=`> ${msg}`;
  log.appendChild(entry);
  log.scrollTop=log.scrollHeight;
}

// --- Toggle Rules ---
function toggleRules(){
  const rules=document.getElementById('ruleset');
  rules.classList.toggle('minimized');
}

// --- Card Creation ---
function createCard(type,name,value=0,desc=""){ return {type,name,value,desc}; }
const allCards = [];

// --- Variable Cards ---
['Integer','Boolean','String','Char[]','Media','Class','Button/Key'].forEach(t=>{
  let count=t==='Integer'?12:t==='Boolean'?6:t==='String'?5:t==='Char[]'?5:t==='Media'?9:t==='Class'?5:8;
  for(let i=1;i<=count;i++) allCards.push(createCard('Variable',`${t} ${i}`,t==='Boolean'?2:i,'Variable of type '+t));
});

// --- Function Cards ---
['Assign','Evaluate','Add','Subtract','Multiply','Divide','Calculator','coinFlip','Print','Concatenate','Conjoin','populateArray','populateMatrix','playSound','showImage','playVideo','createServer','sendPing','newDatabase','awaitInput','Animate','textBasedAdventure','simpleGame','MMO','screenSaver'].forEach(f=>allCards.push(createCard('Function',f,0,'Function '+f)));

// --- Loop Cards ---
['Do','For','While'].forEach(l=>allCards.push(createCard('Loop',l,0,'Loop '+l)));

// --- Library Cards ---
['IOstream','Vector','Winmm','SDL2','GDIplus','Ctime','pygame','numpy','socket','math.js','WebSocket'].forEach(l=>allCards.push(createCard('Library',l,0,'Library '+l)));

// --- Bonus Cards ---
['Controller Support','Bluetooth Compatible','Database Included','Backup Save','Port Forwarding','Remote Server','Borrowed Code','AI Integration','Web Client','Memory Optimization','Language Integration','SQL-Friendly'].forEach(b=>allCards.push(createCard('Bonus',b,5,'Bonus '+b)));

// --- Bug Cards ---
['Segmentation Fault','Memory Leak','Syntax Error','Corrupted File'].forEach(b=>allCards.push(createCard('Bug',b,0,'Bug '+b)));

// --- Event Cards ---
['Servers Down','Office Party','New Equipment','Sticky Keys','Install Wizard','Reboot','System Overload','Stack Overflow','Behind Schedule','Overachiever','Promotion','New Management','Trash Day','Reorganization','Blind Debugging'].forEach(e=>allCards.push(createCard('Event',e,0,'Event '+e)));

// --- If/Else Cards ---
for(let i=1;i<=10;i++) allCards.push(createCard('IfElse',`IfElse ${i}`,i,'IfElse card '+i));

// --- Shuffle ---
function shuffle(deck){ for(let i=deck.length-1;i>0;i--){ let j=Math.floor(Math.random()*(i+1)); [deck[i],deck[j]]=[deck[j],deck[i]]; }}

// --- Function Requirements ---
const funcRequirements = {
  Assign: {vars:['any'], libs:[]}, Evaluate:{vars:['any','any'], libs:[]},
  Add:{vars:['Integer','Integer'],libs:[]}, Subtract:{vars:['Integer','Integer'],libs:[]},
  Multiply:{vars:['Integer','Integer'],libs:[]}, Divide:{vars:['Integer','Integer'],libs:[]},
  Calculator:{vars:['Integer','Integer'],libs:['IOstream']}, coinFlip:{vars:['Boolean'],libs:[]},
  Print:{vars:['String'],libs:['IOstream']}, Concatenate:{vars:['String'],libs:['IOstream']},
  Conjoin:{vars:['String','String'],libs:['IOstream']},
  populateArray:{vars:['same'],loops:1,libs:['Vector']}, populateMatrix:{vars:['any'],loops:1,libs:['Vector']},
  playSound:{vars:['Media'],libs:['Winmm','pygame','HTML5']}, showImage:{vars:['Media'],libs:['Winmm','pygame','HTML5']},
  playVideo:{vars:['Media'],libs:['Winmm','pygame','HTML5']},
  createServer:{vars:['String','String','String'],libs:['libcurl','socket','WebSocket']}, sendPing:{vars:['String','String'],libs:['libcurl','socket','WebSocket']},
  newDatabase:{vars:['Class'],libs:['libcurl','socket','WebSocket']}, awaitInput:{vars:['Button/Key'],loops:1,libs:[]},
  Animate:{vars:['Media','Media','Media'],loops:1,libs:['GDIplus','pygame','PixiJS']},
  textBasedAdventure:{vars:['Class'],loops:2,funcs:1,libs:['IOstream']},
  simpleGame:{vars:['Class'],extras:['awaitInput','playSound','Animate'],libs:[]},
  MMO:{extras:['simpleGame','createServer'],vars:[],libs:[]},
  screenSaver:{extras:['Animate','playSound','awaitInput'],vars:[],libs:[]}
};

// --- Render Functions ---
function renderPlayers(){
  const container=document.getElementById('players');
  container.innerHTML='';
  players.forEach((p,idx)=>{
    const div=document.createElement('div');
    div.className='player-area';
    div.innerHTML=`<h3>${p.name} ${idx===currentPlayer?'(Current)':''}</h3>
      <strong>Score:</strong> ${p.score}<br>
      <strong>Hand:</strong><div id="hand-${idx}"></div>
      <strong>Language Deck:</strong> <div id="langDeckCount-${idx}">${p.langDeck.length} cards</div>`;
    container.appendChild(div);
    renderHand(idx);
  });
}

function renderHand(idx){
  const handDiv=document.getElementById(`hand-${idx}`);
  handDiv.innerHTML='';
  players[idx].hand.forEach((c,i)=>{
    const cDiv=document.createElement('div');
    cDiv.className=`card ${c.type}`;
    cDiv.textContent=c.name;
    cDiv.onmouseover=()=>showCardInfo(c);
    if(idx===currentPlayer) cDiv.onclick=()=>playCard(i);
    handDiv.appendChild(cDiv);
  });
}

function renderDeck(){ document.getElementById('deckCount').textContent=`Cards left: ${mainDeck.length}`; }

function renderProgram(){
  const div=document.getElementById('programArea'); div.innerHTML='';
  const p=players[currentPlayer];
  p.program.forEach((c,i)=>{
    const cDiv=document.createElement('div');
    cDiv.className=`card ${c.type}${selectedFunctionIndex===i?' selected':''}`;
    let scoreText=c.type==='Function'&&c.score?` (${c.score})`:'';
    cDiv.textContent=c.name+scoreText;
    cDiv.onmouseover=()=>showCardInfo(c);

    if(c.type==='Function'){
      cDiv.onclick=()=>{ selectedFunctionIndex=i; renderProgram(); };
      if(!c.variables) c.variables=[];
      if(!c.score) c.score=0;
    }
    div.appendChild(cDiv);
    if(c.variables){
      c.variables.forEach(v=>{
        const vDiv=document.createElement('div');
        vDiv.className=`card ${v.type}`;
        vDiv.textContent=v.name;
        div.appendChild(vDiv);
      });
    }
  });
}

function showCardInfo(card){ document.getElementById('cardInfoText').textContent=`${card.name} (${card.type}): ${card.desc} Value: ${card.value}`;}

// --- Actions ---
document.getElementById('drawMainBtn').onclick=()=>{
  const p=players[currentPlayer];
  if(p.hand.length>=MAX_HAND) return alert('Hand full!');
  if(mainDeck.length===0) return alert('Main deck empty!');
  const card=mainDeck.pop();
  p.hand.push(card);
  logAction(`${p.name} drew from Main Deck: ${card.name}`);
  renderHand(currentPlayer);
  renderDeck();
};

document.getElementById('drawLangBtn').onclick=()=>{
  const p=players[currentPlayer];
  if(p.hand.length>=MAX_HAND) return alert('Hand full!');
  if(p.langDeck.length===0) return alert('Language deck empty!');
  const card=p.langDeck.pop();
  p.hand.push(card);
  logAction(`${p.name} drew from Language Deck: ${card.name}`);
  renderHand(currentPlayer);
  renderPlayers();
};

// --- Play Card ---
function playCard(idx){
  const p=players[currentPlayer];
  const card=p.hand[idx];
  if(card.type==='Variable' && selectedFunctionIndex!==null){
    const func=p.program[selectedFunctionIndex];
    const req=funcRequirements[func.name];
    if(!func.variables) func.variables=[];
    // Check type limits
    if(req.vars && func.variables.length>=req.vars.length) return alert('Function has enough variables.');
    func.variables.push(card);
    logAction(`${p.name} assigned ${card.name} to ${func.name}`);
    p.hand.splice(idx,1);
    renderHand(currentPlayer);
    renderProgram();
    return;
  }
  logAction(`${p.name} played ${card.type}: ${card.name}`);
  p.hand.splice(idx,1);
  if(card.type==='Function') card.score=0;
  p.program.push(card);
  renderHand(currentPlayer);
  renderProgram();
}

// --- Score Program ---
document.getElementById('completeProgramBtn').onclick=()=>{
  const p=players[currentPlayer];
  let valid=true;
  let totalScore=0;
  for(const f of p.program){
    if(f.type==='Function'){
      const req=funcRequirements[f.name];
      let fScore=f.variables.reduce((s,v)=>s+(typeof v.value==='number'?v.value:0),0);
      // Check required variables
      if(req.vars && f.variables.length<req.vars.length){
        logAction(`Function ${f.name} incomplete! Missing variables.`);
        valid=false;
      }
      // Add difficulty multipliers
      if(['populateArray','populateMatrix','playSound','showImage','playVideo'].includes(f.name)) fScore*=2;
      if(['createServer','sendPing','newDatabase','awaitInput','Animate'].includes(f.name)) fScore*=3;
      if(['textBasedAdventure','simpleGame','MMO','screenSaver'].includes(f.name)) fScore*=5;
      f.score=fScore;
      totalScore+=fScore;
    } else if(f.type==='Variable') totalScore+=f.value;
    else if(f.type==='Bonus') totalScore+=f.value;
  }
  if(!valid) return alert('Program incomplete! Check variables.');
  p.score+=totalScore;
  logAction(`${p.name} completed program worth ${totalScore} points! Total: ${p.score}`);
  p.program=[];
  selectedFunctionIndex=null;
  if(p.score>=PROGRAMS_TO_WIN*10){ // simplified win check
    alert(`${p.name} wins!`);
    document.getElementById('game').style.display='none';
    return;
  }
  nextPlayer();
};

document.getElementById('passBtn').onclick=()=>{ 
  logAction(`${players[currentPlayer].name} passed their turn.`);
  nextPlayer(); 
};

function nextPlayer(){ 
  currentPlayer=(currentPlayer+1)%players.length; 
  logAction(`It is now ${players[currentPlayer].name}'s turn.`);
  renderPlayers(); 
  renderProgram(); 
}

// --- New Game ---
document.getElementById('newGameBtn').onclick=()=>{
  NUM_PLAYERS=parseInt(document.getElementById('numPlayers').value);
  const size=document.getElementById('gameSize').value;
  PROGRAMS_TO_WIN=size==='quick'?1:3;
  currentPlayer=0;
  players.length=0;
  mainDeck=[];
  for(let i=0;i<NUM_PLAYERS;i++){
    const langDeck=allCards.filter(c=>['Function','Loop','Library'].includes(c.type));
    shuffle(langDeck);
    const hand=[];
    for(let h=0;h<MAX_HAND;h++){
      if(langDeck.length>0) hand.push(langDeck.pop());
    }
    players.push({name:`Player ${i+1}`, hand:hand, programs:[], score:0, program:[], langDeck:langDeck});
  }
  mainDeck=allCards.filter(c=>['Variable','Bonus','Bug','Event','IfElse'].includes(c.type));
  shuffle(mainDeck);
  document.getElementById('consoleLog').innerHTML='';
  logAction(`New game started with ${NUM_PLAYERS} players. First to ${PROGRAMS_TO_WIN} programs wins.`);
  document.getElementById('game').style.display='flex';
  renderPlayers();
  renderDeck();
  renderProgram();
};
</script>
</body>
</html>
